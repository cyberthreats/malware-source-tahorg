		BITS	32
global		_start
_start:		push	byte 11
		pop	eax
		push	dword 0x0000dead
		mov	ebx, esp
		xor	ecx, ecx
		xor	edx, edx
		int	0x80
		pop	ebx
		or	eax, eax
		jz	.infected
		lea	ecx, [memory_clean]
		jmp	short .print
.infected:	lea	ecx, [memory_infected]
.print:		push	byte 4
		pop	eax
		push	byte 1
		pop	ebx
		push	byte 20
		pop	edx
		int	0x80
		xor	eax, eax
		xor	ebx, ebx
		inc	eax
		int	0x80
memory_infected	db "Virus in memory :-)", 0x0a
memory_clean	db "Memory is clean :-(", 0x0a
;EOF